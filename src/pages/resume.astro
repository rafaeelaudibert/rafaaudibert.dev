---
import BaseLayout from "../layouts/BaseLayout.astro"

import ContactCTA from "../components/ContactCTA.astro"
import Link from "../components/Link.astro"
import KeyboardShortcut from "../components/KeyboardShortcut.astro"

import work from "../assets/work.jpg"
import posthog from "../assets/companies/posthog.png"
import leadsimple from "../assets/companies/leadsimple.png"
import taglivros from "../assets/companies/taglivros.png"
import feeng from "../assets/companies/feeng.png"

import { Image } from "astro:assets"

export const BACKGROUND_CONTENT = [
  "Rafael has 7+ years of experience in various industries, ranging from seed- stage SaaS startups to growth-stage scaleups. Proven track record of working with <b>Ruby on Rails</b>, <b>Python + Django</b>, <b>Typescript + React</b>, and <b>Elixir + Phoenix</b>, building reliable and scalable software. He's motivated by creating new and engaging customer-centric apps loved by clients.",
  "His passion is to build products that are both functional and aesthetically pleasing. More importantly, he wants the product to do exactly what the customers needs it to do. He has a strong background in both front-end and back-end development, and he is always looking for new challenges to tackle.",
]

export const PAST_EXPERIENCES = [
  {
    company: "PostHog",
    imageSrc: posthog,
    href: "https://posthog.com",
    role: "Product Engineer",
    startDate: "11/2024",
    endDate: "Present",
    bulletPoints: [
      "Working on the Web Analytics small team, building a new product to help companies understand their customers and improve their products.",
      "Leading the <strong>Core Web Vitals + Performance</strong> tracking feature.",
    ],
  },
  {
    company: "LeadSimple",
    imageSrc: leadsimple,
    href: "https://leadsimple.com",
    role: "Senior Software Engineer",
    startDate: "03/2021",
    endDate: "10/2024",
    bulletPoints: [
      "Built the company's flagship product in <strong>Ruby on Rails</strong> + <strong>React/TS</strong>, with a fully-fledged <strong>GraphQL API</strong>, deploying tens of times every day.",
      "Implemented integrations with 4 big players in the Proptech industry, including 2-way sync PubSub-based infrastructure",
      "Reduced frontend bundle size by 95% by applying modern frontend bundling practices while migrating from CRA to <strong>Vite</strong>.",
      "Grew company by 2 orders of magnitude while making sure both the database and app architecture were capable of sustaining the higher load by migrating the company infrastructure from Heroku to AWS.",
    ],
  },
  {
    company: "TAG Livros",
    imageSrc: taglivros,
    href: "https://taglivros.com.br/",
    role: "Software Engineer",
    startDate: "11/2019",
    endDate: "03/2021",
    bulletPoints: [
      "Developed a novel logistics IaaC microservice architecture, integrating with tens of shipping companies, to handle 70k deliveries/month in a continental country such as Brazil, using <strong>Terraform</strong>.",
      "Maintained a legacy <strong>Django</strong> monolith responsible for the subscription process, while rewriting the old fiscal/billing system on Serverless.",
      "Built an internal CLI to coordinate the company software deployment process, <strong>decreasing deployment time by 60%</strong>.",
    ],
  },
  {
    company: "FEENG/UFRGS",
    imageSrc: feeng,
    href: "https://www.feeng.com.br/",
    role: "Software Engineer",
    startDate: "03/2017",
    endDate: "11/2019",
    bulletPoints: [
      "Led the initial MVP for the Brazilian government in a 3-month timeframe with a team of 3 junior engineers, and got the project greenlit by the government.",
      "Built a <strong>fully-dockerized Ruby on Rails MVC</strong> application for the Brazilian public health system UPSs (small health clinics spread through Brazilian neighborhoods)",
      "Provisioned infrastructure in AWS, using <strong>EC2, RDS, ELB, Route 53, and Cloudwatch</strong>.",
    ],
  },
]

export const EDUCATION_AND_ACHIEVEMENTS = [
  {
    year: "2022",
    description:
      "<i>summa cum laude</i> Bachelor's degree in Computer Science from Universidade Federal do Rio Grande do Sul (UFRGS), Brazil",
  },
  {
    year: "2021",
    description:
      "Exchange student at the Technische UniversitÃ¤t Kaiserslautern (TUK), Germany",
  },
  {
    year: "2019/2020",
    description:
      "2-time finalist in the Brazilian Competitive Programming Contest (ICPC)",
  },
]

export const LANGUAGES = [
  { language: "Portuguese", level: "Native" },
  { language: "English", level: "Professional Working Proficiency" },
  { language: "Spanish", level: "Limited Working Proficiency" },
  { language: "German", level: "Elementary Proficiency" },
]

export const TECHNOLOGIES = [
  {
    type: "Programming Languages",
    technologies: ["Ruby", "Python", "Typescript", "Javascript", "Elixir"],
  },
  {
    type: "Frameworks",
    technologies: [
      "Ruby on Rails",
      "Django",
      "React",
      "Phoenix",
      "NextJS",
      "Gatsby",
      "Astro",
    ],
  },
  {
    type: "Databases",
    technologies: ["PostgreSQL", "Clickhouse", "Redis", "Elasticsearch"],
  },
  {
    type: "Cloud",
    technologies: [
      "AWS (Lambda, DynamoDB, S3, CloudFront, CloudWatch, RDS, ELB, Route 53)",
      "Vercel",
      "Netlify",
    ],
  },
  {
    type: "Tools",
    technologies: [
      "Docker",
      "Kubernetes",
      "Terraform",
      "Git",
      "GitHub",
      "GitLab",
      "CI/CD",
      "Semaphore CI",
      "Github Actions",
      "GA4",
      "PostHog",
    ],
  },
]
---

<BaseLayout title="Resume | Rafa Audibert" description="Rafa Audibert's Resume">
  <div class="stack gap-20 mb-4">
    <main class="wrapper about">
      <div class="cv-header">
        <Image src={work} alt="Rafael Audibert" class="profile-image" />
        <div class="name-title-section">
          <h1 class="cv-name">Rafael Audibert</h1>
          <p class="cv-title">Senior Product Engineer</p>
          <div class="print-suggestion">
            <span class="print-text"
              >ðŸ’¡ Tip: Press <KeyboardShortcut keys={["Ctrl/Cmd", "P"]} /> to print</span
            >
          </div>
        </div>
      </div>

      <section>
        <h2 class="section-title">Background</h2>
        <div class="content">
          {BACKGROUND_CONTENT.map((content) => <p set:html={content} />)}
        </div>
      </section>

      <section>
        <h2 class="section-title">Past Experience</h2>
        <div class="content">
          {
            PAST_EXPERIENCES.map((experience) => (
              <p>
                <div class="company-header">
                  <Image src={experience.imageSrc} alt={experience.company} />
                  <span>
                    <strong>{experience.role}</strong> at{" "}
                    <Link href={experience.href}>{experience.company}</Link> â€”{" "}
                    {experience.startDate} - {experience.endDate}
                  </span>
                </div>

                <ul>
                  {experience.bulletPoints.map((bulletPoint) => (
                    <li set:html={bulletPoint} />
                  ))}
                </ul>
              </p>
            ))
          }
        </div>
      </section>

      <section>
        <h2 class="section-title">Education &amp; Achievements</h2>
        <div class="content">
          <ul>
            {
              EDUCATION_AND_ACHIEVEMENTS.map((content) => (
                <li>
                  <strong>{content.year}</strong>:{" "}
                  <span set:html={content.description} />
                </li>
              ))
            }
          </ul>
        </div>
      </section>

      <section>
        <h2 class="section-title">Languages</h2>
        <div class="content">
          <ul>
            {
              LANGUAGES.map((language) => (
                <li>
                  {language.language} ({language.level})
                </li>
              ))
            }
          </ul>
        </div>
      </section>

      <section>
        <h2 class="section-title">Things I've worked with before</h2>
        <div class="content">
          In no specific order <span class="help-text"
            >(help with <KeyboardShortcut keys={["Ctrl/Cmd", "F"]} />)</span
          >:
          <br />
          <ul>
            {
              TECHNOLOGIES.map((technology) => (
                <li>
                  {technology.type}: {technology.technologies.join(", ")}
                </li>
              ))
            }
          </ul>
        </div>
      </section>
    </main>
  </div>

  <ContactCTA />
</BaseLayout>

<style>
  ul {
    margin-bottom: 1.5rem;
  }

  .company-header {
    margin-left: 0.7rem;
    display: inline-flex;
    gap: 0.3rem;
    align-items: center;
  }

  .company-header img {
    height: 24px;
    width: 24px;
  }

  .about {
    display: flex;
    flex-direction: column;
    gap: 3.5rem;
  }

  /* CV Header Styles */
  .cv-header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
    padding: 1rem 0;
  }

  .profile-image {
    width: 120px;
    height: 150px;
    border-radius: 16px;
    object-fit: cover;
    box-shadow: var(--shadow-md);
    flex-shrink: 0;
  }

  .name-title-section {
    flex: 1;
  }

  .cv-name {
    font-size: var(--text-4xl);
    font-weight: 700;
    color: var(--gray-0);
    margin: 0;
    margin-bottom: 0.5rem;
    font-family: var(--font-brand);
  }

  .cv-title {
    font-size: var(--text-lg);
    color: var(--gray-300);
    margin: 0;
    font-weight: 500;
  }

  /* Print Suggestion - Subtle */
  .print-suggestion {
    text-align: left;
    margin-top: 0.5rem;
    opacity: 0.7;
  }

  .print-text {
    font-size: var(--text-sm);
    color: var(--gray-400);
    font-style: italic;
  }

  /* Responsive adjustments */
  @media (max-width: 50em) {
    .cv-header {
      flex-direction: column;
      text-align: center;
      gap: 1rem;
      margin-bottom: 1rem;
      padding: 0.5rem 0;
    }

    .profile-image {
      width: 280px;
      height: 350px;
      align-self: center;
    }

    .cv-name {
      font-size: var(--text-3xl);
    }

    .print-suggestion {
      text-align: center;
    }
  }

  /* Print Optimizations */
  @media print {
    /* Hide unnecessary elements */
    :global(nav),
    :global(footer),
    :global(aside) {
      display: none !important;
    }

    /* Hide web-specific content */
    .hero {
      display: none !important;
    }

    /* Hide tagline when printing */
    .tagline {
      display: none !important;
    }

    /* Hide help text when printing */
    .help-text {
      display: none !important;
    }

    /* Hide print suggestion when actually printing */
    .print-suggestion {
      display: none !important;
    }

    /* Remove backgrounds and optimize for black & white printing */
    :global(body) {
      background: white !important;
      color: #1a1a1a !important;
      font-size: 12pt;
      line-height: 1.4;
    }

    :global(.backgrounds) {
      background: none !important;
    }

    /* Optimize layout for print */
    .stack {
      gap: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
    }

    .wrapper {
      max-width: none !important;
      padding: 0.5in !important;
      margin: 0 !important;
    }

    .about {
      gap: 1.5rem !important;
      display: block !important;
      grid-template-columns: none !important;
    }

    /* Show CV header in print */
    .cv-header {
      display: flex !important;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      page-break-after: avoid;
      padding: 0 !important;
    }

    .profile-image {
      width: 60px !important;
      height: 75px !important;
      border-radius: 8px !important;
      object-fit: cover;
      box-shadow: none !important;
      flex-shrink: 0;
    }

    .name-title-section {
      flex: 1;
    }

    .cv-name {
      font-size: 18pt !important;
      font-weight: bold;
      color: #1a1a1a !important;
      margin: 0;
      margin-bottom: 0.25rem;
    }

    .cv-title {
      font-size: 12pt !important;
      color: #333 !important;
      margin: 0;
      font-weight: normal;
    }

    /* Typography optimizations */
    h1,
    h2,
    h3,
    h4,
    h5 {
      color: #1a1a1a !important;
      page-break-after: avoid;
      margin-top: 0.5rem;
      margin-bottom: 0.25rem;
    }

    .section-title {
      font-size: 14pt !important;
      font-weight: bold;
      color: #1a1a1a !important;
      border-bottom: 1pt solid #1a1a1a;
      padding-bottom: 2pt;
      margin-bottom: 0.5rem !important;
      page-break-after: avoid;
    }

    /* Content spacing */
    section {
      display: block !important;
      margin-bottom: 1rem !important;
      page-break-inside: avoid;
      gap: 0.25rem !important;
    }

    .content {
      margin-left: 0 !important;
      grid-column: auto !important;
    }

    /* Company header optimizations */
    .company-header {
      margin-left: 0 !important;
      margin-bottom: 0.25rem;
      page-break-inside: avoid;
    }

    /* Keep company logos in print - smaller size for clean appearance */
    .company-header img {
      width: 16px !important;
      height: 16px !important;
    }

    /* List optimizations */
    ul {
      margin-bottom: 0.75rem !important;
      margin-left: 1rem;
    }

    li {
      margin-bottom: 0.25rem;
      page-break-inside: avoid;
    }

    /* Link styling for print - company names not underlined */
    :global(a) {
      color: #1a1a1a !important;
      text-decoration: none !important;
      font-size: 0.95em;
    }

    /* Show URLs after links for print - smaller text, this is clickable */
    :global(a[href]:after) {
      content: " (" attr(href) ")";
      font-size: 0.8em;
      color: #444;
      text-decoration: none;
      cursor: pointer;
    }

    /* Ensure page breaks work well */
    p {
      page-break-inside: avoid;
      margin-bottom: 0.5rem;
    }

    /* Remove shadows and decorative elements */
    * {
      box-shadow: none !important;
      border-radius: 0 !important;
    }

    /* Page break controls */
    section:nth-child(1) {
      page-break-before: avoid;
    }

    section:nth-child(n + 2) {
      page-break-before: avoid;
    }

    /* Ensure the first section (Background) stays with title */
    section:first-of-type {
      page-break-after: avoid;
    }
  }

  section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    color: var(--gray-200);
  }

  .section-title {
    grid-column-start: 1;
    font-size: var(--text-xl);
    color: var(--gray-0);
  }

  .content {
    grid-column: 2 / 4;
  }

  .content :global(a) {
    text-decoration: 1px solid underline transparent;
    text-underline-offset: 0.25em;
    transition: text-decoration-color var(--theme-transition);
  }

  .content :global(a:hover),
  .content :global(a:focus) {
    text-decoration-color: currentColor;
  }

  @media (min-width: 50em) {
    .about {
      display: grid;
      grid-template-columns: 1fr 60% 1fr;
    }

    .about > :global(:first-child) {
      grid-column-start: 2;
    }

    section {
      display: contents;
      font-size: var(--text-lg);
    }
  }
</style>
